<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>

   <extension
         id="com.github.gradusnikov.eclipse.assistai.fragment"
         point="org.eclipse.e4.workbench.model">
      <fragment
            apply="always"
            uri="fragment.e4xmi">
      </fragment>
   </extension>
   <extension
         point="org.eclipse.ui.preferencePages">
      
      <page
            class="com.github.gradusnikov.eclipse.assistai.preferences.models.ModelPreferencePage"
            id="com.github.gradusnikov.eclipse.assistai.preferences.OpenAIPreferencePage"
            name="AssistAI">
      </page>
        <page
            id="com.github.gradusnikov.eclipse.assistai.preferences.PromptsPreferencePage"
            name="Prompts"
            category="com.github.gradusnikov.eclipse.assistai.preferences.OpenAIPreferencePage"
            class="com.github.gradusnikov.eclipse.assistai.preferences.prompts.PromptsPreferencePage">
        </page>      
        <page
            id="com.github.gradusnikov.eclipse.assistai.preferences.ModelListPreferencePage"
            name="Models"
            category="com.github.gradusnikov.eclipse.assistai.preferences.OpenAIPreferencePage"
            class="com.github.gradusnikov.eclipse.assistai.preferences.models.ModelListPreferencePage">
        </page>
        <page
            id="com.github.gradusnikov.eclipse.assistai.preferences.McpServerPreferencePage"
            name="MCP Servers"
            category="com.github.gradusnikov.eclipse.assistai.preferences.OpenAIPreferencePage"
            class="com.github.gradusnikov.eclipse.assistai.preferences.mcp.McpServerPreferencePage">
        </page>
        <page
            id="com.github.gradusnikov.eclipse.assistai.preferences.McpHttpServerPreferencePage"
            name="HTTP MCP Server"
            category="com.github.gradusnikov.eclipse.assistai.preferences.OpenAIPreferencePage"
            class="com.github.gradusnikov.eclipse.assistai.preferences.mcp.McpHttpServerPreferencePage">
        </page>
   </extension>
   <extension
         point="org.eclipse.core.runtime.preferences">
      <initializer
            class="com.github.gradusnikov.eclipse.assistai.preferences.PreferenceInitializer">
      </initializer>
   </extension>
   <extension point="org.eclipse.ui.startup">
       <startup class="com.github.gradusnikov.eclipse.assistai.PluginStartup"/>
   </extension>
   
   <!-- LLM Code Completion Extension -->
   <extension
         point="org.eclipse.jdt.ui.javaCompletionProposalComputer"
         id="assistAICompletionProposalComputer"
         name="AssistAI Code Completion">
      <javaCompletionProposalComputer
            class="com.github.gradusnikov.eclipse.assistai.completion.LLMCompletionProposalComputer"
            categoryId="org.eclipse.jdt.ui.javaAllProposalCategory"
            needsSortingAfterFiltering="false">
         <partition type="__dftl_partition_content_type"/>
      </javaCompletionProposalComputer>
   </extension>
   
   <!-- Command for AI Code Completion -->
   <extension point="org.eclipse.ui.commands">
      <category
            id="com.github.gradusnikov.eclipse.assistai.commands.category"
            name="AssistAI">
      </category>
      <command
            id="com.github.gradusnikov.eclipse.assistai.commands.aiCompletion"
            name="AI Code Completion"
            description="Trigger AI-powered code completion"
            categoryId="com.github.gradusnikov.eclipse.assistai.commands.category">
      </command>
   </extension>
   
   <!-- Handler for AI Code Completion Command -->
   <extension point="org.eclipse.ui.handlers">
      <handler
            commandId="com.github.gradusnikov.eclipse.assistai.commands.aiCompletion"
            class="com.github.gradusnikov.eclipse.assistai.completion.AICompletionHandler">
      </handler>
   </extension>
   
   <!-- Key Binding for AI Code Completion -->
   <extension point="org.eclipse.ui.bindings">
      <key
            commandId="com.github.gradusnikov.eclipse.assistai.commands.aiCompletion"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
            sequence="Alt+/"
            contextId="org.eclipse.jdt.ui.javaEditorScope">
      </key>
   </extension>

</plugin>
